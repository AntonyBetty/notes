# 第1章 换个角度玩EXCEL

## 第1节 两招让你脱胎换骨

- 在本书中，研究两件事：
  - **一是设计一个标准、正确的源数据表。**
  - **二是“变”出N个分类汇总表。**
- 我们使用Excel的最终目的，是**为了得到各式各样用于决策的分类汇总表**。这些表都是自动“变”出来的。

## 第2节 天下只有一张表

- 源数据表只应有一张，且只应是一维数据格式。





# 第2章 十宗罪进行时

## 第1节 表格中的”父子关系“

- 对Excel来说，**分类汇总表是源数据表的“儿子”。**

## 第2节 错误的“正确”做法毁了你的表格

### 第一宗罪——标题的位置不对

- Excel提供了**两种记录标题的方式：命名工作簿与命名工作表。**不要用标题占用工作表首行。

### 第二宗罪——令人纠结的填写顺序

- 我们在Excel中的动作，尤其是**数据录入的动作，必须与工作顺序保持一致。**

- 【列移动小技巧】：选中列，按住Shift再移动。

### 第三宗罪——人为设置的分隔列破坏了数据完整性

- **不要用空白列充当分隔列。**如果真的需要看一块一块的数据，可以设置单元格格式，将**边框加粗，也能达到相同视觉效果，且不影响数据完整**。

### 第四宗罪——多余的合计行

- “一边记录源数据、一边求和”是错误行为。正确的做法是，**添加辅助列，为明细数据添加新的属性。**比如，如果希望能按月份进行汇总，就添加月份信息；如果希望按照员工所属部门进行汇总，就添加部门信息。
- 【工作好习惯】：在对数据进行分析或者探索之前，先将源数据备份一份，可以保护数据安全。

### 第五宗罪——多余的表头，并由此造成错误的数据记录方式

- **但凡是同一种属性的数据，都应该记录在同一列。**

- 对于源数据表中的**明细数据，只要有任何一个属性不同，都应该分别记录。**

- 【单元格一键批量录入小技巧】：Ctrl有复制的功能；Enter代表单元格录入完毕。将二者组合起来，就是：**Ctrl + Enter ， 将录入完毕的数据同时赋值到所有选定单元格。**

### 第六宗罪——合并单元格严重破坏了数据结构

- “合并及居中”的适用范围，仅限于需要打印的表单，如招聘表、签到表等。而在**源数据表中**，它被全面禁止使用，即**任何情况下都不需要出现合并单元格。**
- 源数据表里的明细数据必须有一条记录一条，所有单元格都应该被填满，每一行数据都必须完整且结构整齐。
- **合并单元格之所以影响数据分析，是因为合并以后，只有首个单元格有数据，其他的都是空白单元格。**
- 【处理合并单元格小技巧】：①全选数据；②点击”合并及居中“按钮，拆分合并单元格；③按F5调用“定位”功能，设定“定位条件”；④选中“空值”为定位条件，点确定；⑤直接输入当前单元格的上一个单元格坐标，如当前是B4，则输入”=B3"；⑥按Ctrl+Enter一键批量录入；⑦由于填充的单元格中的是公式，而非纯文本，还要运用选择性粘贴将单元格内的公式转换为纯文本。

### 第七宗罪——数据残缺不全

- 作为一个源数据表，没数据也不能留白，否则会影响数据分析的结果。
- 在数据区域数值部分的空白单元格里填上0值，文本部分的空白单元格里填上相应的文本数据，才是最严谨的源数据记录方式。

### 第八宗罪——源数据被分别记录在不同的工作表

- 分开源数据很容易，合起来却很难。既然这样，我们就应该**把同类型的数据录入到一张工作表中，而不要分开记录（插入多个Sheet中）。**

### 第九宗罪——在一个单元格里记录了复合属性

- 该条类似于数据库的**第一范式。**每一列都是不可分割的基本数据项，同一列中不能有多个值，即实体中的某个属性不能有多个值或者不能有重复的属性。
- 【数据合并小技巧】：**"&"代表“合并”，即拼接多个单元格中的数据内容。**

### 第十宗罪——汇总表误用手工来做

- **用手工做分类汇总表，是一种越俎代庖的行为。**
- **把分类汇总表交给Excel，我们只需专心做好源数据表。**





# 第3章 Excel 超越你的想象

## 第1节 三表概念——难道Excel也是系统

- 三表概念：**一个完整的工作簿只有三张工作表。**三个Sheet分别是：参数表、源数据表、分类汇总表。

### 第一张表——参数表

- **参数表里的数据**可以等同于系统的配置参数，**供源数据表和分类汇总表调用**，属于基础数据，通常为表示数据匹配关系或者某属性明细等不会经常变更的数据。

### 第二张表——源数据表

- Excel中一切与数据录入相关的工作，都在源数据表中进行，我们的日常工作最主要的就是做好源数据表。

### 第三张表——分类汇总表

- 此处的“分类汇总表”代指所有的“变”出来的分类汇总表。

## 第2节 左手企业系统，右手Excel

- 企业系统提供规范、完整、及时的源数据，Excel则把它展现为个性化的各类汇总表。

## 第3节 Excel 决定企业存亡

- 指的是通过Excel 进行数据分析，通过数据进行决策，更加科学合理。





# 第4章 玩转透视表，工作的滋味甜过初恋

## 第1节 数据透视表初体验

- **天下第一表**的设计是心法，**数据透视表**的运用是招式，要成为“武林高手”，二者缺一不可。
- 数据透视表是自动生成分类汇总表的工具。

## 第3节 汇总报表，拖拽有“理”

- **在制作汇总表时，分类多的字段，应该尽量作为行字段；分类少的字段，才可以作为列字段**，这样有利于在一个页面上显示更多的数据内容，也符合一般人的阅读习惯。
- 形象的说，**我们在拖拽字段时，一定不要让汇总表“躺着”，而要让它“站起来”。**
- 根据Excel默认的数据结构，工作表中的行数比列数多几百倍，整个工作表是**姚明般的身材**。

- **不超过两个列字段原则。**当汇总表的列字段超过2个，数据透视表的逻辑是，先展开第一级字段，在第一级字段的每一个分类下，展开第二级字段，以此类推。

- 做汇总表时，**两个列字段是极限**，一个列字段是标准。**建议在任何时候都尽可能只设置一个列字段**，其余想要汇总的字段，可以按顺序添加在行字段。

- 【小技巧】：**汇总跟着文字走。**

  例如：求，不同省份、不同会计制度类别、不同行业**在**不同营业状态下**的**全年营业收入总和。

  - 省份：一级行字段
  - 会计制度类别：二级行字段
  - 行业：三级行字段
  - 营业状态：列字段
  - 全年营业收入总和：需要汇总的数据字段

- **字段的主次关系**对于数据分析结果十分重要。

## 第4节 巧妙组合日期

- **日期是汇总表不可或缺的组成部分。**
- 日期字段怎么放？**如果不需要对比每个月的领用情况，就可以将日期放入页片段。**

- 在数据透视表里，可以**对日期进行组合，从而从不同的时间维度（按月汇总、按季汇总等）进行数据分析。**
- 常见的正确的日期录入方式只有两种：
  - 一是“减号”型。——以“-”为分隔符号录入的日期，如：2020-02-10。
  - 二是“正斜杠”型。——以“/”为分隔符号录入的日期，如：2011/1/10。

- 检验日期的方法很简单：**将单元格格式设置为常规，如果日期变成了一组数字，就是正确的日期。如果日期仍然是日期，就是错误的日期。**

## 第5节 追根溯“源”

- **如果是通过数据透视表生成的汇总表，将它发送给其他人之前，务必先确认对方是否需要看到数据明细。如果答案为否，就用选择性粘贴把汇总表粘贴为数值再发送**，否则容易泄露个人隐私！

## 第6节 关联数据齐步走

- 如果希望汇总表同步更新，应该在源数据表中做添加、删除、修改操作，而非在查看数据明细的工作表里。

## 第7节 你还应该知道这几招

- 数据透视表也能完成去重操作：
  - 针对某一字段，**在数据透视表里做两次处理：首先把它拖为行字段，然后把它从字段列表中拖入数据项区域。**
- 数据透视表是允许复制的，粘贴后的表格具备透视表的所有功能，可以单独进行设置，这为一源多表提供了最大的便捷。





# 第5章 揭秘天下第一表的神奇“配方”

## 第1节 学Excel不是走单行线

- 设计天下第一表和“变”表互为因果。

## 第2节 五味良药“配”出天下第一表

- Vlookup属于查找与引用函数。作用是：**查找某单元格数据在源数据库中是否存在，如存在，则返回源数据库中同行指定列的单元格内容；如不存在，则返回#N/A。**
- Vlookup函数的规定：**待查找的数据库的首列必须为待匹配字段**。
- Column函数的作用是：返回单元格的列号。可以和Vlookup函数联合使用实现向右拉。
- 对于源数据表的格式：
  - **文本对齐。**垂直方向上居中对齐，同列数据水平方向采用同样的对齐方式。
  - **文本大小。**10号。
  - **字体。**中文用宋体，英文用Times New Roman。
  - **突出标题行。**以区分数据行。





# 第6章 图表，怎么简单怎么做

## 第1节 别把Excel中的图表当做PPT做

- 图表越简约越好，重点是要说明问题。

## 第3节 无外乎三种图表

- **对比份额、分布等信息时，可以用饼图**，它来**说明比例关系，而不强调数值本身。**
- **对比数值时，用柱形图。**柱形图**既关注多个数值之间的大小关系，也关注单个数值本身**。
- **表示趋势时，用折线图。**通常折线图用来反映多个时期的数据变化。

## 第4节 一招美化你的图表

- 干净。**保持背景和色彩的干净，才能突出焦点。**
- 原配。**默认的图表类型几乎都是最好的**，不用再尝试其他。
- 大小。图大、字小就能突出图形特色，**不要让文字影响图表的可读性。**
- 简约。简约很重要。





# 第7章 低头做表别忘了抬头看路

## 第1节 赢得同事的认可

- 与同事之间没有汇报关系，**只要不给别人添麻烦，且让人觉得你这人做事靠谱，就能及格。如果能再有些小幽默，且善于分享，会加分更多。**
- “是金子总会发光“在当今可能不再适用。要主动找机会展示。
- 待人真诚勿算计。

## 第2节 赢得老板的认可

- 为老板分忧，就是为自己创造机会。
- 比吩咐的多想一点、多做一点。
- **主动是很好的素质，主动的人永远占尽先机，被动的人永远丧失良机。**
- 汇报进度并按时完成。
- 在写邮件之前，先插入附件。
- 在邮件中对重要附件进行简单描述，概括核心观点。
- **给出自己的建议，并让老板做选择题。**注意，即便提供了多个解决方案，我们也要给出建议的最佳方案，并说明理由。













