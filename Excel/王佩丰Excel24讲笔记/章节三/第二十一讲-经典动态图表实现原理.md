# 1、使用IF函数实现动态图表的效果

![动态图表](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节三\第二十一讲图片\动态图表.png)

## ①第一步：插入表单控件

![动态图表-1](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节三\第二十一讲图片\动态图表-1.png)

上图，插入2个表单控件（制作2个按钮、2个图）。

![动态图表-2](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节三\第二十一讲图片\动态图表-2.png)

![动态图表-3](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节三\第二十一讲图片\动态图表-3.png)

上图，将表单控件的选取对应到一个单元格中。

## ②自定义区域名称和引用位置

![动态图表-4](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节三\第二十一讲图片\动态图表-4.png)

上图，使用IF函数引用一个动态区域

![动态图表-5](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节三\第二十一讲图片\动态图表-5.png)

注意，=IF(Sheet1!$G$6,Sheet1!$B$2:$B$13,Sheet1!$F$2:$F$13) ，使用IF函数动态引用，必须在每个参数上都要设置绝对引用！

 ## ③创建空白图表，添加数据

![动态图表-6](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节三\第二十一讲图片\动态图表-6.png)

![动态图表-7](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节三\第二十一讲图片\动态图表-7.png)

注意上述引用方式！ “ = sheet1!+引用区域名称"



# 2、OFFSET函数：以某个点为基准，下移N行、右移N列，取N行、N列



# 3、使用OFFSET函数创建动态区域：=OFFSET($A$1,0,0,COUNTA($A:$A),列数)

## ①创建自定义名称，输入上述公式，创建一个动态区域

![动态区域-2](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节三\第二十一讲图片\动态区域-2.png)

注意1：COUNTA($A:$1)表示返回A列的非空行数；

注意2：在自定义名称中写入代码，所有涉及区域的必须是绝对引用。

## ②创建数据透视表时候，将“区域”处写上自定义的那个区域名称

![动态区域](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节三\第二十一讲图片\动态区域.png)

## ③当区域数据发生变化时候，在数据透视表中右键点击刷新即可满足动态区域的数据更新

![动态区域-1](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节三\第二十一讲图片\动态区域-1.png)



# 4、动态图表的创建

## ①需求：不管数据源中有多少行，图表中永远反映最后10条的数据

![动态图表-1-1](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节三\第二十一讲图片\动态图表-1-1.png)

## ②创建自定义名称，取某列的最后10条数据：OFFSET函数+COUNTA函数

=OFFSET($B$1,COUNTA($B:$B)-10,0,10,1)

注意1：相关参数均取绝对引用。

注意2：上述公式的意思是，以B1单元格为参考点，向下走（B列总行数-10）行、向右走0列，取10行、1列，即能正常取到B列的动态的最后10行。

## ③创建图表，插入数据，动态显示成交量

![最后10行](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节三\第二十一讲图片\最后10行.png)

## ④再次插入数据，动态显示日期

![动态](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节三\第二十一讲图片\动态.png)

 

# 5、OFFSET函数存在的意义：可以动态的取一定范围的区域值，实现动态效果



# 6、动态图表的创建——两个滑动框

![动态图表——2个滑动框](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节三\第二十一讲图片\动态图表——2个滑动框.png)

上图，滑动框实现效果与标题4中的代码类似。