# 1、VLOOKUP函数三个参数的通俗理解：去隔壁办公室、找老张、把老张的水杯拿过来



# 2、VLOOKUP函数的要求：找老张，在选择范围时，老张所在的列必须是最左侧的列



# 3、VLOOKUP函数的最后一个参数中，0代表精确匹配，1代表模糊匹配。99%的情况下都要用精确匹配。



# 4、VLOOK函数第二个参数，进行选区时，注意使用绝对引用！

![VLOOKUP跨表引用](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节二\第十一讲图片\VLOOKUP跨表引用.png)

VLOOKUP函数同样可以使用跨表引用。



# 5、VLOOUP函数中使用通配符“&”

![VLOOKUP中使用通配符](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节二\第十一讲图片\VLOOKUP中使用通配符.png)

要查找的数据是“三川实业”，而数据源中的公司名称为“三川实业有限责任公司”，这本质上仍然是一个精确查找的问题，在查找的值中写入A2&“*”即可找全相关值，原理是通过使用通配符表明要查找的内容后面可能还有其他内容。



# 6、VLOOKUP使用模糊查询频次很少，只限于从没有数据的表中查找，会找<=自己的最大值（注意：查询列表需要从小到大排序）

![VLOOKUP模糊查询](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节二\第十一讲图片\VLOOKUP模糊查询.png)

上图，从左边找不存在该年龄的值，会找<=41岁的最大值，即37岁，不会找大于自己的42岁！



# 7、模糊查询应用-计算提成比例（模糊查询仅用于此处，其余情况99%都用精确匹配）

![模糊查询应用-计算提成比例](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节二\第十一讲图片\模糊查询应用-计算提成比例.png)

上图，计算提成比例，使用模糊查询找到<=自己值的那个最大值，可以很合适的匹配对应的提成比例，不会虚高。

【注意】模糊查询基于二分法算法，因此使用模糊查询时，要确保查询的数值列表中，数值是从小到大排列的！



# 8、VLOOKUP函数中的数字格式问题-文本和数值

![数字格式-1](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节二\第十一讲图片\数字格式-1.png)

①上图，查找列表中的格式是文本，编号列是数值，可以让查找的编号连上字符“”，这样Excel会默认将编号的数值格式强制转换为文本格式。

![数字格式-2](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节二\第十一讲图片\数字格式-2.png)

②上图，查找列表中的格式是数值，编号列是文本，可以在查找的编号前加两个负号（负负得正，其实就是让Excel转换数值格式）或者乘以1，这样Excel会默认将编号的文本格式强制转换为数值格式。

![数字格式-3](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节二\第十一讲图片\数字格式-3.png)

③上图，如果编号列和查找列都有数值、文本格式，此时可以借助IF函数、ISNA函数进行判断。

逻辑是，首先按照编号全部都是数值（A1*1）进行查找，如果找到了，就返回数值，如果没找到（返回NA错误），那么继续将编号用文本（A1&“”）进行查找!



# 9、HLOOKUP函数与VLOOKUP函数逻辑一样，适用于表格格式不一样的情况

![HLOOKUP函数](D:\StudyMaterials\IT技术学习\1、Excel\王佩丰Excel24讲笔记\章节二\第十一讲图片\HLOOKUP函数.png)
